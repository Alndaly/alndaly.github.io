"use strict";(self.webpackChunkalndaly_github_io=self.webpackChunkalndaly_github_io||[]).push([[2002],{2140:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"backend/Node/Koa/\u7ea7\u8054","title":"\u7ea7\u8054","description":"Koa \u4e2d\u95f4\u4ef6\u4ee5\u66f4\u4f20\u7edf\u7684\u65b9\u5f0f\u7ea7\u8054\uff0c\u60a8\u53ef\u80fd\u4e60\u60ef\u4f7f\u7528\u7c7b\u4f3c\u7684\u5de5\u5177 - \u4e4b\u524d\u96be\u4ee5\u8ba9\u7528\u6237\u53cb\u597d\u5730\u4f7f\u7528 node \u7684\u56de\u8c03\u3002\u7136\u800c\uff0c\u4f7f\u7528 async \u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0 \u201c\u771f\u5b9e\u201d \u7684\u4e2d\u95f4\u4ef6\u3002\u5bf9\u6bd4 Connect \u7684\u5b9e\u73b0\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u529f\u80fd\u76f4\u63a5\u4f20\u9012\u63a7\u5236\uff0c\u76f4\u5230\u4e00\u4e2a\u8fd4\u56de\uff0cKoa \u8c03\u7528\u201c\u4e0b\u6e38\u201d\uff0c\u7136\u540e\u63a7\u5236\u6d41\u56de\u201c\u4e0a\u6e38\u201d\u3002","source":"@site/docs/backend/Node/Koa/\u7ea7\u8054.md","sourceDirName":"backend/Node/Koa","slug":"/backend/Node/Koa/\u7ea7\u8054","permalink":"/en/docs/backend/Node/Koa/\u7ea7\u8054","draft":false,"unlisted":false,"editUrl":"https://github.com/Alndaly/alndaly.github.io/tree/main/packages/create-docusaurus/templates/shared/docs/backend/Node/Koa/\u7ea7\u8054.md","tags":[],"version":"current","lastUpdatedAt":1742396220000,"sidebarPosition":3,"frontMatter":{"title":"\u7ea7\u8054","sidebar_position":3},"sidebar":"backEndSidebar","previous":{"title":"\u5b89\u88c5","permalink":"/en/docs/backend/Node/Koa/\u5b89\u88c5"},"next":{"title":"\u7aef\u53e3\u7ed1\u5b9a","permalink":"/en/docs/backend/Node/Koa/\u7aef\u53e3\u7ed1\u5b9a"}}');var s=t(5105),a=t(3881);const c={title:"\u7ea7\u8054",sidebar_position:3},r=void 0,i={},d=[];function l(n){const e={admonition:"admonition",code:"code",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.admonition,{type:"info",children:(0,s.jsx)(e.p,{children:"Koa \u4e2d\u95f4\u4ef6\u4ee5\u66f4\u4f20\u7edf\u7684\u65b9\u5f0f\u7ea7\u8054\uff0c\u60a8\u53ef\u80fd\u4e60\u60ef\u4f7f\u7528\u7c7b\u4f3c\u7684\u5de5\u5177 - \u4e4b\u524d\u96be\u4ee5\u8ba9\u7528\u6237\u53cb\u597d\u5730\u4f7f\u7528 node \u7684\u56de\u8c03\u3002\u7136\u800c\uff0c\u4f7f\u7528 async \u529f\u80fd\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0 \u201c\u771f\u5b9e\u201d \u7684\u4e2d\u95f4\u4ef6\u3002\u5bf9\u6bd4 Connect \u7684\u5b9e\u73b0\uff0c\u901a\u8fc7\u4e00\u7cfb\u5217\u529f\u80fd\u76f4\u63a5\u4f20\u9012\u63a7\u5236\uff0c\u76f4\u5230\u4e00\u4e2a\u8fd4\u56de\uff0cKoa \u8c03\u7528\u201c\u4e0b\u6e38\u201d\uff0c\u7136\u540e\u63a7\u5236\u6d41\u56de\u201c\u4e0a\u6e38\u201d\u3002"})}),"\n",(0,s.jsx)(e.p,{children:"\u4e0b\u9762\u4ee5 \u201cHello World\u201d \u7684\u54cd\u5e94\u4f5c\u4e3a\u793a\u4f8b\uff0c\u5f53\u8bf7\u6c42\u5f00\u59cb\u65f6\u9996\u5148\u8bf7\u6c42\u6d41\u901a\u8fc7 x-response-time \u548c logging \u4e2d\u95f4\u4ef6\uff0c\u7136\u540e\u7ee7\u7eed\u79fb\u4ea4\u63a7\u5236\u7ed9 response \u4e2d\u95f4\u4ef6\u3002\u5f53\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u8c03\u7528 next() \u5219\u8be5\u51fd\u6570\u6682\u505c\u5e76\u5c06\u63a7\u5236\u4f20\u9012\u7ed9\u5b9a\u4e49\u7684\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u3002\u5f53\u5728\u4e0b\u6e38\u6ca1\u6709\u66f4\u591a\u7684\u4e2d\u95f4\u4ef6\u6267\u884c\u540e\uff0c\u5806\u6808\u5c06\u5c55\u5f00\u5e76\u4e14\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u6062\u590d\u6267\u884c\u5176\u4e0a\u6e38\u884c\u4e3a\u3002"}),"\n",(0,s.jsx)(e.admonition,{title:"\u6ce8\u610f",type:"info",children:(0,s.jsx)(e.p,{children:"\u8fd9\u4e2anext\u51fd\u6570\u662f\u771f\u7684\u4ece\u4e0a\u5230\u4e0b\uff0c\u5373\u6587\u4ef6\u4e2d\u7684app.use\u7684\u5148\u540e\u987a\u5e8f\u6267\u884c\uff0c\u5230\u5e95\u90e8\u5c55\u5f00\u540e\uff0c\u518d\u53cd\u5411\u5411\u4e0a\u3002"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-javascript",children:"const Koa = require('koa');\nconst app = new Koa();\n\nconst sleep = (ms) =>\n\tnew Promise((resolve) => {\n\t\tsetTimeout(() => {\n\t\t\tresolve();\n\t\t}, ms);\n\t});\n\n// logger\n\napp.use(async (ctx, next) => {\n\tconsole.log(1)\n\tawait next();\n\tconst rt = ctx.response.get('X-Response-Time');\n\tconsole.log(`${ctx.method} ${ctx.url} - ${rt}`);\n});\n\n// x-response-time\n\napp.use(async (ctx, next) => {\n\tconsole.log(2)\n\tconst start = Date.now();\n\tawait sleep(2000);\n\tawait next();\n\tconst ms = Date.now() - start;\n\tconsole.log(ms)\n\tctx.set('X-Response-Time', `${ms}ms`);\n});\n\n// response\n\napp.use(async (ctx) => {\n\tconsole.log(3)\n\tctx.body = 'Hello World';\n});\n\napp.listen(3000);\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"\u4e0a\u8ff0\u4ee3\u7801\u7684\u6253\u5370\u987a\u5e8f\u5e94\u662f"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-plaintext",children:"1\n2\n3\n2004\nGET / - 2004ms\n"})})]})}function p(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},3881:(n,e,t)=>{t.d(e,{R:()=>c,x:()=>r});var o=t(8101);const s={},a=o.createContext(s);function c(n){const e=o.useContext(a);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),o.createElement(a.Provider,{value:e},n.children)}}}]);